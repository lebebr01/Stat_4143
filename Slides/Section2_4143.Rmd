% PSQF 4143: Section 2
% Brandon LeBeau

# Summarizing Data
- Data in its raw form is often too complex to summarize and understand quickly.
- As such, summarizing the data with descriptive statistics (section 3) or with tables and graphs (this section) can be very helpful.

# Motivating Example
```{r summarize}
# Function to wrap printing.
wrap_print <- function(table, num_row = NULL, num_col = 2) {
  if(is.null(num_row)) {
    num_row <- nrow(table)/2
  }
  ngroups <- nrow(table)/num_row
  
  tmp <- lapply(1:ngroups, function(xx) 
    table[((xx-1)*num_row+1):((xx-1)*num_row + num_row), ])
  tmp <- do.call("cbind", tmp)
  return(tmp)
}

library(ggplot2)
library(dplyr)
title_movie <- c('Mean Girls', 'Notebook, The', 'Troy',
                 'Incredibles, The', 
                 'Harry Potter and the Prisoner of Azkaban',
                 'Napoleon Dynamite', 
                 'Eternal Sunshine of the Spotless Mind',
                 'Crash', '13 Going On 30', 
                 'Girl Next Door, The', 
                 'Dodgeball: A True Underdog Story',
                 'Anchorman: The Legend of Ron Burgundy',
                 'Million Dollar Baby',
                 'Shaun of the Dead', 'White Chicks',
                 'Spider-Man 2', 'Saw', 'Dawn of the Dead',
                 'Van Helsing', 'Cinderella Story, A', 
                 'King Arthur', 'Phantom of the Opera, The',
                 '50 First Dates', 'Aviator, The', 
                 'Kill Bill: Vol. 2', 'Punisher, The',
                 'Village, The', 'Collateral',
                 'Butterfly Effect, The', 'Hellboy')
freq_tab <- movies %>%
  filter(title %in% title_movie & year == 2004) %>%
  select(title, length)
wrap_print(freq_tab, num_row = 15)
```

# Ungrouped Frequency Table
<br>
<br>
<br>
<br>
<br>
<br>
<br>

# Ungrouped Frequency Table Creation Steps
- To create an ungrouped frequency table:
    1. List all numbers from the minimum to maximum
    2. Count the number that fall within each number
    3. Numbers can have 0 frequency
    
- Strengths:
    - Able to see all the numbers in the distribution
    - Can quickly glance at the range
    - Can quickly see which number is most frequent.
- Weaknesses:
    - Tables can be large depending on range
    - Lose some information, namely who had which value
    
# Grouped Frequency Table
<br>
<br>
<br>
<br>
<br>
<br>
<br>

# Grouped Frequency Table Creation Steps
- To create a grouped frequency table:
    1. First need to find the class interval size
       $$ i = Real Upper Limit - Real Lower Limit $$
    2. List out all the class intervals
    3. Count the number that fall within each interval
    
- Strengths:
    - Can quickly see where most values fall
    - 
- Weaknesses:
    - No longer know exact values
    - The choice of class interval size can influence the table

# Additional Notes for Grouped Frequency Tables
- The class intervals should be mutually exclusive
- For quantitative values, no gaps between class intervals
- All class intervals should be the same size
- On average, 10 to 20 class intervals are most appropriate
- Common class interval sizes include: 1, 2, 3, 5, 10, 15, 20, 25, ...
- The lower limit should equal the class size times a constant integer (i.e. 5 * 10 = 50)

# Relative Frequency Distributions
- These are frequency distributions with proportion or percentage of each class interval
- Useful for comparisons of two or more groups especially when the number in each group differ

# Relative Frequency by Groups
```{r freqgroups}
tmp_movies <- movies %>%
  filter(year == 2004 & mpaa %in% c('PG', 'R')) %>%
  select(length, mpaa)
breaks <- seq(10, 180, by = 15)
tmp <- split(tmp_movies, tmp_movies$mpaa)
tmp <- lapply(1:length(tmp), function(xx)
  cut(tmp[[xx]]$length, breaks, right = FALSE))
tmp2 <- data.frame(length = c(tmp[[3]], tmp[[5]]), 
                   mpaa = rep(c('PG', 'R'), 
                              times = c(length(tmp[[3]]),
                                        length(tmp[[5]]))))
tmp_tab <- table(tmp2$length, tmp2$mpaa)
```

# Cumulative Frequency Distributions
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

# Cumulative Frequency Creation
1. Start with a basic frequency distribution, grouped or ungrouped.
2. Starting with the smallest value, keep a running tally of the number encountered.
    - This can be done by taking the frequency for the current category plus all prior categories
3. Optional - add columns for cumulative proportion or cumulative percentage.

# Frequency Distribution for Qualitative Variables
```{r qual}
table(movies$mpaa)
```

# Graphs
- Graphs are a great alternative to many of the tables we discussed above as they tend to be easier to quickly interpret and understand.
- One benefit of graphs is the ability to explore the shape of distributions.
- However, it is also easier to create misleading graphics.
- Graphs for quantiative variables:
    - Histograms
    - Frequency Polygons
    - Cumulative Polygon (Ogive)
    - Stem and Leaf
- Graphs for qualitative variables:
    - Bar Graphs
    - Pie Charts
- Note: there are many other graphs that can be used too that we are not discussing.

# Histograms
- A histogram is a visual representation of a frequency table for quantitative variables.
- No gaps between bars as the x-axis is continuous.

```{r hist}
h <- ggplot(freq_tab, aes(x = length)) + theme_bw(base_size = 16)
h + geom_histogram(binwidth = 10, color = "grey30") + 
  scale_x_continuous(breaks = seq(70, 180, 10))
```

# Frequency Polygons
- A frequency polygon is also a visual representation of a frequency table for quantitative variables.
- This plot is great for more than two groups.

```{r freqpoly}
fp <- ggplot(freq_tab, aes(x = length)) + theme_bw(base_size = 16)
fp + geom_freqpoly(binwidth = 10) + 
  scale_x_continuous(breaks = seq(70, 180, 10))
```


# Frequency Polygons by Group
```{r freqpolygroup}
tmp_tab_df <- data.frame(tmp_tab)
names(tmp_tab_df) <- c('mp', 'mpaa', 'Freq')
tmp_tab_df$mp <- as.numeric(as.character(tmp_tab_df$mp))
tmp_tab_df <- rbind(tmp_tab_df, c(4, 'PG', 0), c(4, 'R', 0))
tmp_tab_df$mp <- as.numeric(tmp_tab_df$mp)
tmp_tab_df$Freq <- as.numeric(tmp_tab_df$Freq)
tmp_tab_df <- arrange(tmp_tab_df, mpaa, mp)
tmp_tab_df$mid <- rep(c(17, 32, 47, 62, 77, 92, 107, 122, 137, 152, 167), 2)
fp <- ggplot(tmp_tab_df, aes(x = mid, y = Freq, color = mpaa)) + theme_bw(base_size = 16)
fp + geom_freqpoly(stat = 'identity') + geom_point() + 
  scale_x_continuous(breaks = seq(2, 182, 15))
```

# Cumulative Polygon (Ogive)
- The cumulative polygon or ogive, is a graphical representation of the cumulative frequency.
- This plot is unique in that it is always increasing.

```{r ogive}
breaks <- seq(70, 180, 10)
length_cut <- cut(freq_tab$length, breaks, right = FALSE)
length_tab <- table(length_cut)
cumfreq <- c(0, cumsum(length_tab))
length_df <- data.frame(freq = c(0, length_tab), cf = cumfreq, brks = seq(70, 180, 10))
cf <- ggplot(length_df, aes(x = brks, y = cf)) + theme_bw(base_size = 16)
cf + geom_point() + geom_line() + 
  scale_x_continuous("Length", breaks = breaks) + 
  ylab("Cumulative Freq")
```

# Stem and Leaf
- Stem and leaf displays are similar to histograms, but specific points can be identified.
- Outside of introductory statistics books, I do not see these used in practice.
- The leaf is the last number, the stem is the remaining portion of the number.

```{r stem}
stem(freq_tab$length)
```

# Bar Graphs
- Bar graphs are a way to visually show a frequency table for qualitative variables.
- Can also be used to show other variables on the y-axis for qualitative variables.
- Has gaps to show the differences in groups.
- Order should be meaningful, either alphabetical for nominal variables or in the correct order for ordinal variables.

```{r bar}
b <- ggplot(filter(movies, mpaa != ''), aes(x = mpaa)) + theme_bw(base_size = 16)
b + geom_bar()
```

# Pie Charts
- Pie charts are useful to show the percentage of the whole for each group.
- The sum of the pieces of the pie must add up to 100% for this chart to be meaningful.

```{r pie}
pie_tab <- table(filter(movies, mpaa != '')$mpaa)[2:5]
lbls <- paste(names(pie_tab), "\n", pie_tab, sep = "")
pie(pie_tab, labels = lbls)
```

# Shapes of Distributions
- Distributions can be categorized based on their symmetry (skewness) and kurtosis.
- Symmetry/Skewness is the amount a distribution leans one way or the other.
    - A symmetric distribution is one where each half of the distribution are mirror images of one another.
    - An asymmetric (skewed) distribution is one where they are not mirror images.
    - A positively (right) skewed distribution is one where the bulk of data lie in the lower portion with a long upper tail.
    - A negatively (left) skewed distribution is one where the bulk of data lie in the upper portion with a long lower tail.
- Kurtosis refers to the peakedness of the distribution. Relatedly, this also refers to the portion of the distribution that resides in the tails.
    - Mesokurtic refers to an intermediate distribution with average tails and peakedness.
    - Platykurtic refers to a distribution that is flatter with more observations in the tail.
    - Leptokurtic refers to a distribution that is steeper with fewer observations in the tail.
    
# Examples of common shapes
![Distribution Shapes]()

# Poor graphics
- Care needs to be made when constructing good graphics.
- It is easy for graphs to mislead/mask the purpose. 
- The goal should be to easily convey the message.

[Poor Charts](http://flowingdata.com/2013/07/15/open-thread-what-is-wrong-with-these-charts/)

# Interesting Graphic Examples
[Languages other than English Spoken at home](http://www.washingtonpost.com/wp-srv/special/national/us-language-map/)

[The Racial Dot Map](http://www.coopercenter.org/demographics/Racial-Dot-Map)


